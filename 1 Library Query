1)
SELECT B.Book_id, B.Title, B.Pub_name, BA.Author_name, BC.Branch_id, BC.No_of_Copies 
FROM Book B 
JOIN Book_authors BA ON B.Book_id = BA.Book_id 
JOIN Book_Copies BC ON B.Book_id = BC.Book_id;

2)
SELECT BL.Card_no, COUNT(*) AS Books_Borrowed 
FROM Book_Lending BL 
WHERE BL.Date_out BETWEEN '2017-01-01' AND '2023-06-30' 
GROUP BY BL.Card_no 
HAVING COUNT(*) > 3;

3)
DELETE FROM Book_Lending
WHERE Book_id = '123';

DELETE FROM Book_Copies
WHERE Book_id = '123';

DELETE FROM Book_authors
WHERE Book_id = '123';


DELETE FROM Book
WHERE Book_id = '123';

4)
CREATE VIEW BOOK_BY_YEAR AS 
SELECT Book_id, Title, Pub_name, Pub_Year 
FROM Book 
where Pub_year='2019-12-05';

SELECT * FROM BOOK_BY_YEAR;

5)
CREATE VIEW AVAILABLE_BOOK_COPIES AS 
SELECT B.Book_id, B.Title, BC.Branch_id, BC.No_of_copies
FROM Book B 
JOIN Book_Copies BC ON B.Book_id = BC.Book_id;

6)
select * from AVAILABLE_BOOK_COPIES;




